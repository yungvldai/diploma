\section{РАЗРАБОТКА КОНСТРУКЦИИ СТЕНДА}

\subsection{Бесконтактный моментный двигатель}

% TODO: включить БМП в список сокращений
В качестве основного двигателя, на базе которого и построен БМП, 
был выбран двухфазный двигатель ДБМ 63~- 0,06~- 3~- 2. Его примерный внешний вид
приведен на рисунке \ref{dbm63}, а его характеристики представлены в таблице \ref{tab:dbm63}.

\insertimage[scale=0.85]{dbm63}{
  Примерный внешний вид двигателя
}

\begin{tabularx}{\textwidth}{|X|c|}
  \caption{Характеристики двигателя ДБМ 63~- 0,06~- 3~- 2}\label{tab:dbm63}\\
  \hline
    Наружный диаметр статора, мм & 63 \\
  \hline
    Внутренний диаметр ротора, мм & 28 \\
  \hline
    Осевая длина (не более), мм & 28 \\
  \hline
    Число пар полюсов, шт & 8 \\
  \hline
    Номинальное напряжение питания, В & 27 \\
  \hline
    Частота вращения при идеальном холостом ходе, об/мин & 2700-3400 \\
  \hline
    Материал магнитов & Самарий-Кобальт \\
  \hline
\end{tabularx}

Принцип работы двигателя заключается в создании вращающего момента
путем взаимодействия электромагнитного поля статора и магнитного поля ротора.
Вращение поля статора осуществляется переключением обмоток по какому-либо закону
управления. Простым переключением реализуется дискретный или импульсный закон
управления, что заставит ротор вращаться неравномерно, а скачками. Иногда это 
неприемлемо, поэтому существует еще один закон управления~- гармонический или аналоговый.

Его суть заключается не просто в переключении обмоток статора, а также регулировании
амплитуды фазных напряжений, что позволяет получать более плавное движение результирующего 
вектора  МДС, а следовательно и ротора.

У двигателя ДБМ 63 4 обмотки и по-умолчанию они не соединены друг с другом общим проводом.
Различные схемы коммутации приведены на рисунке \ref{connection}.

Внутри каждой из фаз обмотки двигателя можно соединить последовательно или параллельно,
что позволяет повысить скорость вращения или момент на валу. Один из вариантов подключения~- 
вовсе не использовать по одной обмотке из каждой фазы. Также, есть вариант автономного
питания, то есть питания отдельно каждой обмотки. Однако, у всех этих схем подключения есть
один существенный минус~- необходима возможность смены полярности напряжения на обмотке.
При работе с постоянным током это неудобно, к тому же лишний раз усложняет схемотехнику.
Поэтому для модуля был выбран способ подключения, при котором обмотки соединяются
в звезду с общим проводом. Таким образом, менять полярность на обмотках не нужно,
а форму сигнала можно задавать с помощью ШИМ-модуляции. В стенде используется именно
такой вариант подключения.

\insertimage[scale=0.55]{connection}{
  Схемы коммутации двухфазного двигателя серии ДБМ \cite{БеленькийМикеровМоментныйПривод}
}

Посмотрев на циклограммы изменения фазных напряжений на рисунке \ref{connection},
можно заметить, что самый простой запуск двигателя возможен путем подачи на 
любую обмотку первой фазы сигнала синуса и вместе с тем подачи на любую обмотку 
второй фазы сигнала косинуса. Так двигатель будет работать в режиме синхронного двигателя.
Частоту обоих сигналов ради эксперимента можно принять
за 50 герц~- частота переменного напряжения в бытовой сети 220~вольт.
Однако при такой частоте, ротор двигателя будет неприятно гудеть и стоять на месте. 
Это связано с выходом двигателя из синхронизма. Он физически не может моментально 
разогнаться до частоты вращения равной частоте сигналов, поэтому нужно позаботиться 
о плавном разгоне. Огромный плюс синхронных машин заключается в том, что они не 
теряют обороты при любых значениях момента ниже максимального. Здесь же кроется 
и минус~- при превышении значения максимального момента двигатель выходит из 
синхронизма и просто останавливается. Решением проблемы являются различные улучшения,
например, механизмы автосинхронизации или аварийного перезапуска.
В общем то, это и есть главный минус этого режима работы. Такой режим работы подходит
для приводов, где нет работы с большими нагрузками, например, вентиляторы. 
Однако, без механизма корректного запуска все равно не обойтись.
В рассмотренном режиме работы управление двигателем заключается 
в регулировании частоты фазных сигналов.

Конечно, существуют и другие режимы работы двигателя, которые достигаются 
различными способами управления. Например, снабдив описанную ранее синхронную
машину специальным электромеханическим устройством - электронным коммутатором, 
можно получить так называемый вентильный привод. Под электронным коммутатором
подразумевается специальное устройство, осуществляющее коммутацию обмоток двигателя, 
чаще представляющее из себя связку
из датчика положения ротора или датчика скорости и какого-либо вычислительного узла. Обычно устанавливаются 
датчики Холла, это удобно, потому что вращающаяся часть двигателя~- большой магнит, но также
вполне возможно установить энкодер на ротор или даже реостат с полным поворотом. 
Такой способ управления принято называть датчиковым. Суть такого управления 
заключается реализации обратной связи по датчику положения и/или датчику скорости, более просто 
это можно объяснить как переключение обмоток в зависимости от сигналов с датчиков, что очень напоминает работу 
обычных коллекторных ДПТ. Но все таки есть
большое отличие~- коммутация обмоток происходит не механическим путем, а электрическим.
Логично, что для реализации такого метода управления необходим микроконтроллер, либо же просто
специальная электрическая схема. И то, и то нужно для
обработки сигналов с датчиков и подачи напряжения на обмотки двигателя.
Существенный минус данного решения~- как раз таки необходимость
применения электронных модулей, что зачастую довольно дорого и не всегда обоснованно. 

Еще один интересный метод управления~- бездатчиковый. Информация о положении ротора 
вычисляется математически в режиме реального времени на основании той 
информации, которая имеется в системе управления. На рисунке \ref{connection} способ коммутации
с питанием одной секции фазы на самом деле не так прост. При вращении ротора двигателя в 
незапитанных обмотках генерируется обратная ЭДС, которую можно измерить. 
Более того, по этому измерению можно сделать вывод о том, в каком положении ротор 
находится в данный момент, получается, что отдельный датчик положения ротора вовсе и не нужен.
Данный метод управления набирает все большую популярность ввиду того, что вносит
упрощение в конструкцию привода.
У такого способа управления, к сожалению, тоже есть минусы:
\begin{itemize}
  \item Как в случае и с датчиковым управлением, необходим микроконтроллер;
  \item На низких оборотах (около 10\% от номинальной частоты вращения) величина обратной ЭДС,
генерируемой в обмотках недостаточна для определения положения ротора \cite{Инжреш}.
\end{itemize}
В макете использование данного способа управления невозможно по причине отсутствия возможности 
задания отрицательных амплитуд напряжений на обмотках.

В макете управление двигателем реализовано с помощью силовых ключей BTS3256. Каждый из четырех
ключей осуществляет коммутацию нужной обмотки в конкретный момент времени. Эти интеллектуальные ключи
имеют логический уровень 3.3 вольта, что позволяет подключить их напрямую к пинам микроконтроллера.
Немаловажно и то, что эти ключи поддерживают ШИМ-модуляцию, что дает возможность создавать на обмотках 
нужные амплитуды напряжений. Каждая обмотка двигателя ДБМ одним проводом подключена к плюсу внешнего 
блока питания на 24 вольта. А замыкается цепь при подаче логической единицы на вход силового ключа.
Такие ключи называются ключами нижней стороны, так как они осуществляют коммутацию со стороны общего провода.

Также, нельзя упускать, что двигатели серии ДБМ выпускаются в двух исполнениях статора: 
пазовом и беспазовом или гладком. ДБМ 63 имеет беспазовый статор, что позволяет обеспечить
отсутствие реактивного остаточного момента сопротивления, и как следствие 
пульсаций вращающего момента по углу поворота ротора. Также, статор
такого типа обеспечивает малые электромагнитные постоянные времени обмоток.

\subsection{Нагрузочный двигатель постоянного тока}

В качестве нагрузочного двигателя был выбран обычный коллекторный ДПТ Д5-ТР (рисунок \ref{d5tr}). 
Этот двигатель используется для создания искусственной нагрузки на валу 
двигателя ДБМ для исследования и изучения БМП под нагрузкой. Некоторые его характеристик
представлены в таблице \ref{tab:d5tr}.

\insertimage[scale=0.45]{d5tr}{
  Двигатель Д5-ТР
}

\begin{tabularx}{\textwidth}{|X|c|}
  \caption{Характеристики двигателя Д5-ТР}\label{tab:d5tr}\\
  \hline
    Длина, мм & 112 \\
  \hline
    Диаметр, мм & 40 \\
  \hline
    Момент на валу, г·см & 90 \\
  \hline
    Мощность, вт & 3.8 \\
  \hline
    Частота вращения, об/мин & 4100 \\
  \hline
    Масса, кг & 0.5 \\
  \hline
\end{tabularx}

Принцип работы этого двигателя...

Д5-ТР относится к классу исполнительных, то есть рассчитанных на большие 
кратковременные нагрузки. В макете заложена возможность использовать двигатель не только для
создания нагрузки, но и, наоборот, при старте как бы помогать двигателю ДБМ, чтобы
свести трение от подшипников к минимуму и таким образом приблизиться к идеальным условиям.
На стенде этот двигатель не закреплен и имеет одну степень свободы~- может вращаться. Это
достигается установкой двигателя в подшипник. А нужно это для того, чтобы поворотом двигателя в 
подшипнике воздействовать на тензометрический датчик и таким образом измерять момент.

\clearpage

Управление двигателем реализовано с помощью самого простого силового ключа [какого?].
Было решено не предусматривать даже возможность реверса двигателя, так как она просто не нужна
ввиду того, что имеется возможность реверса двигателя ДБМ. По-умолчанию напряжение на двигатель 
поступает так же, от блока питания, однако предусмотрена возможность питания двигателя от другого 
источника.

Для установки на стенд из двигателя был удален тормоз, иначе бы пришлось всякий раз 
запитывать двигатель, чтобы встроенная электромуфта отключала тормоз.

\subsection{Измерительные устройства}

Для измерения различных параметров двигателя ДБМ на стенде предусмотрен целый набор датчиков,
а именно:

\begin{itemize}
  \item Устройство измерения тока для каждой обмотки двигателя ДБМ;
  \item Устройство измерения напряжения для каждой обмотки двигателя ДБМ;
  \item Датчик угла положения ротора;
  \item Тензометрический датчик
\end{itemize}

Показания со всех датчиков собираются микроконтроллером и отправляются на компьютер
с помощью USB-соединения.

Датчики тока и напряжения нужны для снятия электрических показателей двигателя в момент работы.
В качестве монитора напряжения используется самый обычный делитель напряжения в связке
с микроконтроллерным АЦП. Для снятия показаний тока регистрируется падение напряжение на 
шунтирующем резисторе, далее это напряжение усиливается с помощью операционного усилителя и так же
подается на вход АЦП микроконтроллера.

В качестве датчика угла положения ротора был выбран магнитный энкодер AS5048A. Буква A на
конце означает, что эта модификация поддерживает передачу данных по SPI. Также, данный
энкодер поддерживает работу с помощью ШИМ. Такое решение было выбрано по ряду причин:
\begin{itemize}
  \item Поддержка логического уровня 3.3 вольт;
  \item 14-битное разрешение;
  \item Бесконтактное вращение на все 360 градусов без ограничений;
  \item Программируемое начальное положение.
\end{itemize}
Принцип работы заключается в реагировании на изменение магнитного поля у поверхности 
корпуса микроконтроллера. Мощный неодимовый магнит закреплен с торца вала двигателя
таким образом, чтобы не наблюдалось биений. При вращении магнита датчики Холла, 
расположенные внутри вокруг центра микросхемы регистрируют изменения магнитного поля,
результат специальным образом конвертируется и отправляется на микроконтроллер для
дальнейшей обработки. Данная микросхема выполнена в TSSOP14 корпусе. 

Наиболее интересным решением в плане датчиков было использовать тензометрический датчик
для измерения создаваемого на валу двигателя момента. Тензометрический датчик жестко крепится
на корпус макета, а его упругий элемент предотвращает поворот нагрузочного двигателя в подшипнике.
Таким образом, если момент на валу становится достаточно большим, чтобы преодолеть сопротивление
упругого элемента тензометрического датчика, последний подвергается деформации, деформация 
регистрируется
электронной частью датчика и отправляется на микроконтроллер. Благодаря этому можно сделать вывод
о том, какое сейчас значение момента на валу. Тензометрический датчик представляет из себя
реостат, а это означает, что для измерения значения также используется делитель напряжения и АЦП.

Можно заметить, что для чтения данных со всех измерителе устройств используется АЦП и это неспроста. 
Быстродействие АЦП для выбранного микроконтроллера~- не менее двух миллионов преобразований в секунду.
Фактически это означает, что возможно получить не менее двух миллионов значений, например, 
угла в секунду, что довольно много.

\subsection{Микроконтроллер}

В качестве вычислительного модуля для стенда был выбран микроконтроллер STM32F407VGT6, 
а точнее специальная
отладочная плата на базе этого микроконтроллера (рисунок \ref{disco}). Огромным плюсом 
отладочных плат является тот факт, что
вся необходимая для работы обвязка микроконтроллера уже реализована на этой самой плате.
Прямо на ней размещен программатор и различные другие модули для комфортной работы.
Также, все пины микроконтроллера разведены в 2 пятидесятипиновых разъема для быстрого и удобного 
прототипирования.

\insertimage[scale=0.35]{disco}{
  Внешний вид отладочной платы
}

Отладочная плата работает <<из коробки>> и поддерживает большое количество сред разработки,
все драйверы устанавливаются автоматически при подключении к компьютеру. Отладочная
плата имеет отличную интеграцию в пакеты MATLAB и Simulink благодаря библиотеке STM32-MAT/TARGET.
Эта библиотека позволяет разрабатывать структуру системы управления в пакете Simulink, а затем 
по нажатию одной кнопки конвертировать ее в машинный код для микроконтроллера платы.
Благодаря этому при изучении систем управления бесколлекторным моментным двигателем без
погружения в программные аспекты,
можно полностью абстрагироваться от сложных вещей, например, работы с регистрами ARM-ядра,
на котором базируется микроконтроллер.

\subsection{Модуль управления}

Модуль управления представляет из себя печатную плату с коннектором для отладочной платы, необходимыми 
разъемами и другой электроникой. Здесь расположены силовые ключи для управления 
двигателями и другие устройства для обеспечения корректной работы датчиков.
Схема электрическая принципиальная приведена в приложении \ref{app:circ}.

Сама плата выполнена из одностороннего фольгированного текстолита, чертеж платы представлен
в приложении \ref{app:pcb}.

\subsection{Блок питания}

Для питания силовых частей макета используется блок питания NES-100-24. Его характеристики представлены в таблице \ref{tab:pit}

\begin{tabularx}{\textwidth}{|X|c|}
  \caption{Характеристики блока питания}\label{tab:pit}\\
  \hline
    Выходное напряжение, В & 24 \\
  \hline
    Номинальный ток, А & 4.5 \\
  \hline
    Номинальная мощность, Вт & 108 \\
  \hline
\end{tabularx}

\subsection{Описание конструкции}

Сам макет представляет из себя основание, с закрепленными к нему блоком питания, подшипником Z8009 
с внутренним диаметром 40 миллиметров, стаканом с двигателем ДБМ и электроникой. 
В подшипник с натягом устанавливается двигатель Д5-ТР. С помощью специальной муфты валы двигателей
жестко соединяются, при этом двигатель Д5-ТР свободно вращается. С другой, относительно двигателя ДБМ,
стороны на вал устанавливается неодимовый магнит. К корпусу крепится специальный кронштейн таким 
образом, чтобы магнитный энкодер оказался прямо напротив магнита на валу. При этом расстояние не должно
превышать 5 миллиметров. Также к корпусу крепится тензометрический
датчик, который своим упругим элементом ограничивает свободное вращение двигателя Д5-ТР.

С выключенным питанием ротор нагрузочного двигателя свободно прокручивается. Затем, при подаче
напряжения на нагрузочный двигатель, его ротор начинает вращаться либо в том же направлении, что и 
двигатель ДБМ, либо в обратном. Таким образом происходит либо дополнительный разгон, либо 
сопротивление вращению соответственно. Это позволяет исследовать работу двигателя ДБМ под нагрузкой,
а также работу в условиях, близких к идеальным с точки зрения трения.

